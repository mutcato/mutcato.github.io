<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="mutlucan" />
    <meta name="generator" content="Pelican (VoidyBootstrap theme)" />

    <title>Scraping Web Like A Gentleman - Things that i have learned</title>

   
        <link rel="stylesheet"
              href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
              integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
              crossorigin="anonymous" />
      <link rel="stylesheet"
            href="https://use.fontawesome.com/releases/v5.0.13/css/all.css"
            integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"
            crossorigin="anonymous">


      <link rel="stylesheet" href="/theme/css/pygment.css" />
      <link rel="stylesheet" href="/theme/css/voidybootstrap.css" />

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js" integrity="sha384-FFgGfda92tXC8nCNOxrCQ3R8x1TNkMFqDZVQdDaaJiiVbjkPBXIJBx0o7ETjy8Bh" crossorigin="anonymous"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js" integrity="sha384-ZoaMbDF+4LeFxg6WdScQ9nnR1QC2MIRxA1O9KWEXQwns1G8UNyIEZIQidzb0T1fo" crossorigin="anonymous"></script>
    <![endif]-->

    <link rel="shortcut icon" href="/favicon.ico" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36295151-11', '');
  ga('send', 'pageview');

</script>
  </head>

  <body>
   
    <nav class="navbar navbar-default">
      <div class="container">
	   <div class="navbar-header">
		<button type="button" class="navbar-toggle" 
				data-toggle="collapse" data-target="#main-navbar-collapse">
		  <span class="sr-only">Toggle navigation</span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		  <span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="/" rel="home">
          <i class="fas fa-home fa-fw fa-lg"> </i> </a>
       </div>

      <div class="collapse navbar-collapse" id="main-navbar-collapse">
        <ul class="nav navbar-nav">
            <li class="divider"></li>
            <li class="">
              <a href="/archives.html">Archives</a>
            </li>
          <li class="divider"></li>
        </ul> <!-- /nav -->
      </div> <!-- /navbar-collapse -->
	  </div> <!-- /container -->
    </nav> <!-- /navbar -->

	<div class="jumbotron" id="overview">
	  <div class="container">
		<h1><a href="/">Things that i have learned</a></h1>
		<p class="lead">Geeky things that makes me happy</p>
	  </div>
	</div>

    <div class="container" id="main-container">
      <div class="row">
        <div class="col-md-9" id="content">
<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
  <header class="article-header">
<abbr class="article-header-date">
  Çrş 25 Eylül 2019
</abbr> <h1>
  <a href="/scraping-web-like-a-gentleman.html" rel="bookmark"
     title="Permalink to Scraping Web Like A Gentleman">
    Scraping Web Like A Gentleman
  </a>
</h1><div class="article-header-info">
  <p>
      Posted by <a href="/author/mutlucan.html">mutlucan</a>
    in 
    <a href="/category/programming.html">
      Programming</a>
    &nbsp;&nbsp;
  </p>
</div> <!-- /.article-header-info -->  </header>
  <div class="content-body" itemprop="text articleBody">
	<p>There is shit load data in internet. Some of them can be accessible via legal ways like APIs. Some of them cannot...
Most website doesn't make their API public. Then webscrapers and webcrawlers come into the play. 
But there is a problem.  </p>

<p>These websites don't want their data been used by 3rd party apps. For this reason 
they haven't already opened APIs. Some websites don't care about crawlers and scrapers. However big ones, espesicially e-commerce sites, 
which is very interested by scrapers, applies very sophisticated methods to prevent unusual accesses to their sites.
I will try to explain my methods which turn around these sophisticated methods while crawling websites.</p>

<h3>Don't use request libraries</h3>

<p>Websites can detect whether client visits by request library or not. Instead of request, use browsers.
There are some other alternatives but I will give examples from Python and Selenium. So, use Selenium, don't use Request.
</p>

<h3>Edit Chromedriver hex file</h3>

<p>
For chromedriver, search and replace $cdc part with a arbitrary three letter word.
For geckodriver, word be replaced is $wdc.
<img src="https://i.imgur.com/Zzh63OL.png">
<img src="https://i.imgur.com/05be2Mi.png">
</p>

<h3>Use headfull browsers instead of headless ones</h3>

<p>
Don't add `options.add_argument('--headless')` in your Python code.
If you use crontab then add `export DISPLAY=:0;` in your cronjob rule. Or install xvfb and add xvfb-run in cronjob
</p>

<h3>Carefully set your webdriver options</h3>

<p>
It is better to use the browser in incognito mode. We have to be untrackable as much as possible.
Start the browser with fullscreen. Most humanized usage is fullscreen usage.
Even you can check by typing navigator.webdriver in your browser console.
Websites can easily detect whether the request comes from Selenium or an organic user, with typing navigator.webdriver.
So, you need to make it 'undefined'
</p>

<div class="highlight"><pre><span></span>    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;user-agent={user_agent}&quot;</span><span class="p">)</span>
    <span class="c1"># options.add_experimental_option(&#39;useAutomationExtension&#39;, False)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-infobars&#39;</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-extensions&#39;</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--profile-directory=Default&#39;</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--incognito&#39;</span><span class="p">)</span> <span class="c1"># starts Chrome in incognito mode</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-plugins-discovery&#39;</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--start-maximized&#39;</span><span class="p">)</span> <span class="c1"># starts the browser in fullscreen</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s2">&quot;excludeSwitches&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;enable-automation&#39;</span><span class="p">])</span> <span class="c1"># makes navigator.webdriver flag &quot;undefined&quot;</span>
    <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">CHROME_DRIVER</span><span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>  <span class="c1"># Optional argument, if not specified will search path.</span>
</pre></div>


<h3>Add fake and random user agents</h3>

<p>
Download some [user agent list]({static}/pdfs/user-agent-database-full.csv). If there is a bot agent in the list remove them all. You better remove mobile agents.
Pick a random user_agent and add a option parameter with that random agent in each time.
</p>

<div class="highlight"><pre><span></span>    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;user-agent={random_user_agent}&quot;</span><span class="p">)</span>
</pre></div>


<h3>Put it together</h3>

<div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
    <span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
    <span class="n">random_user_agent</span> <span class="o">=</span> <span class="n">scrapage</span><span class="o">.</span><span class="n">random_user_agent</span><span class="p">()</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;user-agent={random_user_agent}&quot;</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-infobars&#39;</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-extensions&#39;</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--profile-directory=Default&#39;</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--incognito&#39;</span><span class="p">)</span> <span class="c1"># starts Chrome in incognito mode</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-plugins-discovery&#39;</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--start-maximized&#39;</span><span class="p">)</span> <span class="c1"># starts the browser in fullscreen</span>
    <span class="n">options</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s2">&quot;excludeSwitches&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;enable-automation&#39;</span><span class="p">])</span> <span class="c1"># makes navigator.webdriver flag &quot;undefined&quot;</span>
    <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="s2">&quot;/absolute/path/chromedriver&quot;</span><span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>  <span class="c1"># Optional argument, if not specified will search path.</span>
</pre></div>


<h2>Run Away From Patterns</h2>

<p>
Big websites uses machine learning and pattern recognition techniques for detecting bots.
You must not build patterns. Your each movement must be human like.
For example: Don't visit product pages from top to down at a time. Shuffle the initial list and then pick random amount at each time.
Wait random periods between actions.
Make the webdriver click on links instead of pulling the url and getting the page from url.
(Clicking is more human behaviour and some JS may work on user clicks)
</p>

<h2>Come from search engines</h2>

<p>
Visiting directly in each time can generate a pattern. So try accesing from search engines.
</p>
  </div>
  
<div class="article-tag-list">
<span class="label label-default">Tags</span>
	<a href="/tag/python.html"><i class="fas fa-tag"></i>python</a>&nbsp;
	<a href="/tag/selenium.html"><i class="fas fa-tag"></i>selenium</a>&nbsp;
	<a href="/tag/bot.html"><i class="fas fa-tag"></i>bot</a>&nbsp;
	<a href="/tag/webdriver.html"><i class="fas fa-tag"></i>webdriver</a>&nbsp;
	<a href="/tag/scraping.html"><i class="fas fa-tag"></i>scraping</a>&nbsp;
</div>  <hr />
  <div class="well well-sm">  <!-- Social media sharing buttons -->

    <!-- Google+ -->
    <div class="g-plus" data-action="share" data-annotation="bubble"></div>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <div class="g-plusone" data-size="medium"></div>&nbsp;

    <!-- Facebook -->
    <div class="fb-like" 
        data-href="/scraping-web-like-a-gentleman.html" 
        data-layout="button_count" 
        data-action="like" data-show-faces="true" 
        data-share="true">
    </div>
    &nbsp;
  </div> <!-- /Social media sharing buttons -->
</article>
        </div><!-- /content -->

        <div class="col-md-3 sidebar-nav" id="sidebar">

<div class="row">

<div class="col-xs-6 col-md-12">
<h4><i class="fas fa-comment fa-fw fa-lg"></i> Social</h4>
<ul class="list-unstyled social-links">
    <li><a href="https://twitter.com/mcan543" target="_blank">
	  <i class="fab fa-twitter-square fa-fw fa-lg" title="Twitter"></i>
		Twitter
	</a></li>
    <li><a href="http://linkedin.com/in/mutlucan" target="_blank">
	  <i class="fab fa-linkedin fa-fw fa-lg" title="LinkedIn"></i>
		LinkedIn
	</a></li>
    <li><a href="https://github.com/mutcato" target="_blank">
	  <i class="fab fa-github-square fa-fw fa-lg" title="GitHub"></i>
		GitHub
	</a></li>
</ul>
</div>

<div class="col-xs-6 col-md-12">
<h4><i class="fas fa-folder fa-fw fa-lg"></i> Categories</h4>
<ul class="list-unstyled category-links">
  <li><a href="/category/ai.html" >
    <i class="fas fa-folder-open fa-fw fa-lg"></i> AI</a></li>
  <li><a href="/category/data.html" >
    <i class="fas fa-folder-open fa-fw fa-lg"></i> Data</a></li>
  <li><a href="/category/database.html" >
    <i class="fas fa-folder-open fa-fw fa-lg"></i> Database</a></li>
  <li><a href="/category/deep-learning.html" >
    <i class="fas fa-folder-open fa-fw fa-lg"></i> Deep Learning</a></li>
  <li><a href="/category/linux.html" >
    <i class="fas fa-folder-open fa-fw fa-lg"></i> Linux</a></li>
  <li><a href="/category/programming.html" >
    <i class="fas fa-folder-open fa-fw fa-lg"></i> Programming</a></li>
  <li><a href="/category/system.html" >
    <i class="fas fa-folder-open fa-fw fa-lg"></i> System</a></li>
</ul>
</div>

</div> <!-- /row -->

<h4><i class="fas fa-tags fa-fw fa-lg"></i> Tags</h4>
<p class="tag-cloud">
      <a href="/tag/python.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>python
      </a>
      <a href="/tag/mongodb.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>mongodb
      </a>
      <a href="/tag/database.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>database
      </a>
      <a href="/tag/javascript.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>javascript
      </a>
      <a href="/tag/google-apps-script.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>google apps script
      </a>
      <a href="/tag/bot.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>bot
      </a>
      <a href="/tag/scraping.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>scraping
      </a>
      <a href="/tag/email.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>email
      </a>
      <a href="/tag/selenium.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>selenium
      </a>
      <a href="/tag/webdriver.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>webdriver
      </a>
      <a href="/tag/slack.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>slack
      </a>
      <a href="/tag/tdd.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>tdd
      </a>
      <a href="/tag/ai.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>AI
      </a>
      <a href="/tag/nn.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>NN
      </a>
      <a href="/tag/linux.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>linux
      </a>
      <a href="/tag/cli.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>cli
      </a>
      <a href="/tag/sequence-models.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>sequence models
      </a>
      <a href="/tag/lstm.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>lstm
      </a>
      <a href="/tag/nlp.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>nlp
      </a>
      <a href="/tag/ssl.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>ssl
      </a>
      <a href="/tag/raspberrypi.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>raspberrypi
      </a>
      <a href="/tag/ubuntu.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>ubuntu
      </a>
      <a href="/tag/oop.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>OOP
      </a>
      <a href="/tag/data-visualition.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>data visualition
      </a>
      <a href="/tag/pandas.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>pandas
      </a>
      <a href="/tag/kaggle.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>kaggle
      </a>
      <a href="/tag/plotly.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>plotly
      </a>
      <a href="/tag/data.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>data
      </a>
      <a href="/tag/pytorch.html">
        <i class="fas fa-tag fa-fw fa-lg"></i>pytorch
      </a>
</p>

<hr />

        </div><!--/sidebar -->
      </div><!--/row-->
    </div><!--/.container /#main-container -->

    <footer id="site-footer">
 
      <address id="site-colophon">
        <p class="text-center text-muted">
        Site built using <a href="http://getpelican.com/" target="_blank">Pelican</a>
        &nbsp;&bull;&nbsp; Theme based on
        <a href="http://www.voidynullness.net/page/voidy-bootstrap-pelican-theme/"
           target="_blank">VoidyBootstrap</a> by 
        <a href="http://voidynullness.net"
           target="_blank">RKI</a>  
        </p>
      </address><!-- /colophon  -->
    </footer>


    <!-- javascript -->
   
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>


<!-- Facebook -->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>

<!-- Twitter -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<!-- Google+ -->
<!-- Synchronous 
<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
-->
<!-- Asynchronous -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/platform.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>  </body>
</html>